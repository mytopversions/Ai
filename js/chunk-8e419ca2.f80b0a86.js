(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e419ca2"],{"7e92":function(t,s,r){},a55b3:function(t,s,r){"use strict";r.r(s);var e=function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("div",{staticClass:"login-page"},[r("div",{staticClass:"card login-card"},[r("h2",{staticClass:"text-center mb-2"},[t._v("钱包解锁")]),t.isFirstTime&&!t.showImportForm?r("div",[r("p",{staticClass:"text-center mb-1"},[t._v("首次使用，请设置访问密码")]),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入访问密码"},domProps:{value:t.password},on:{input:function(s){s.target.composing||(t.password=s.target.value)}}})]),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],attrs:{type:"password",placeholder:"请确认访问密码"},domProps:{value:t.confirmPassword},on:{input:function(s){s.target.composing||(t.confirmPassword=s.target.value)}}})]),t.error?r("p",{staticClass:"error-text"},[t._v(t._s(t.error))]):t._e(),r("button",{staticClass:"btn btn-primary w-100 mb-2",on:{click:t.setupPassword}},[t._v("设置密码")]),r("p",{staticClass:"text-center"},[r("a",{staticClass:"import-link",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.showImport.apply(null,arguments)}}},[t._v("导入钱包数据")])])]):t.showImportForm?r("div",[r("p",{staticClass:"text-center mb-1"},[t._v("导入钱包数据")]),r("div",{staticClass:"form-group"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.importData,expression:"importData"}],staticClass:"form-control",attrs:{placeholder:"请粘贴已导出的加密数据",rows:"4"},domProps:{value:t.importData},on:{input:function(s){s.target.composing||(t.importData=s.target.value)}}})]),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入访问密码"},domProps:{value:t.password},on:{input:function(s){s.target.composing||(t.password=s.target.value)}}})]),t.error?r("p",{staticClass:"error-text"},[t._v(t._s(t.error))]):t._e(),r("div",{staticClass:"btn-group w-100"},[r("button",{staticClass:"btn btn-primary w-50",on:{click:t.importWalletData}},[t._v("导入")]),r("button",{staticClass:"btn btn-secondary w-50",on:{click:t.cancelImport}},[t._v("取消")])])]):t.showResetConfirm?r("div",[r("p",{staticClass:"text-center mb-1"},[t._v("确认删除所有钱包数据")]),r("p",{staticClass:"text-center text-warning mb-2"},[t._v("警告：此操作将永久删除所有钱包数据且无法恢复！")]),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入当前密码以确认删除"},domProps:{value:t.password},on:{input:function(s){s.target.composing||(t.password=s.target.value)}}})]),t.error?r("p",{staticClass:"error-text"},[t._v(t._s(t.error))]):t._e(),r("div",{staticClass:"btn-group w-100"},[r("button",{staticClass:"btn btn-danger w-50",on:{click:t.confirmReset}},[t._v("确认删除")]),r("button",{staticClass:"btn btn-secondary w-50",on:{click:t.cancelReset}},[t._v("取消")])])]):t.showExportForm?r("div",[r("p",{staticClass:"text-center mb-1"},[t._v("导出钱包数据")]),r("p",{staticClass:"text-center text-warning mb-2"},[t._v("请妥善保管导出的数据，其中包含您的所有钱包信息")]),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入访问密码"},domProps:{value:t.password},on:{input:function(s){s.target.composing||(t.password=s.target.value)}}})]),t.exportedData?r("div",{staticClass:"form-group"},[r("label",[t._v("加密数据（请复制并安全保存）：")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.exportedData,expression:"exportedData"}],staticClass:"form-control",attrs:{rows:"4",readonly:""},domProps:{value:t.exportedData},on:{input:function(s){s.target.composing||(t.exportedData=s.target.value)}}}),r("div",{staticClass:"text-center mt-1"},[r("button",{staticClass:"btn btn-sm btn-primary",on:{click:t.copyExportedData}},[t._v("复制")])])]):t._e(),t.error?r("p",{staticClass:"error-text"},[t._v(t._s(t.error))]):t._e(),t.successMessage?r("p",{staticClass:"success-text"},[t._v(t._s(t.successMessage))]):t._e(),r("div",{staticClass:"btn-group w-100"},[t.exportedData?t._e():r("button",{staticClass:"btn btn-primary w-50",on:{click:t.exportWalletData}},[t._v("导出")]),r("button",{staticClass:"btn btn-secondary w-50",on:{click:t.cancelExport}},[t._v("返回")])])]):r("div",[r("p",{staticClass:"text-center mb-1"},[t._v("请输入访问密码解锁钱包")]),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入访问密码"},domProps:{value:t.password},on:{input:function(s){s.target.composing||(t.password=s.target.value)}}})]),t.error?r("p",{staticClass:"error-text"},[t._v(t._s(t.error))]):t._e(),r("button",{staticClass:"btn btn-primary w-100 mb-2",on:{click:t.unlock}},[t._v("解锁钱包")]),r("div",{staticClass:"additional-links"},[r("a",{staticClass:"link-item",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.showExport.apply(null,arguments)}}},[t._v("导出数据")]),r("span",{staticClass:"separator"},[t._v("|")]),r("a",{staticClass:"link-item danger-link",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.showReset.apply(null,arguments)}}},[t._v("删除数据")])])])])])},o=[],a=r("2f62"),i={name:"Login",data(){return{password:"",confirmPassword:"",error:"",successMessage:"",isFirstTime:!1,showResetConfirm:!1,showExportForm:!1,showImportForm:!1,exportedData:"",importData:""}},created(){this.isFirstTime=!localStorage.getItem("encryptedData"),console.log("是否首次使用:",this.isFirstTime)},methods:{...Object(a["b"])(["setPassword","unlockWallets"]),...Object(a["d"])(["SET_UNLOCKED","SET_WALLETS","SET_CURRENT_PASSWORD"]),setupPassword(){if(this.password)if(this.password===this.confirmPassword)try{this.setPassword(this.password),this.SET_CURRENT_PASSWORD(this.password),console.log("密码设置成功"),this.SET_UNLOCKED(!0);const t=this.$route.path;"/wallet"!==t&&this.$router.push("/wallet").catch(t=>{"NavigationDuplicated"!==t.name&&console.error("导航到钱包页面出错:",t)})}catch(t){console.error("设置密码失败:",t),this.error="设置密码失败: "+t.message}else this.error="两次输入的密码不一致";else this.error="请输入密码"},async unlock(){if(this.password)try{console.log("尝试解锁钱包...");const t=await this.unlockWallets({password:this.password});if(t){console.log("解锁成功, 设置解锁状态"),this.SET_UNLOCKED(!0),this.SET_CURRENT_PASSWORD(this.password);const t=this.$route.path;"/operation"!==t&&this.$router.push("/operation").catch(t=>{"NavigationDuplicated"!==t.name&&console.error("导航到操作页面出错:",t)})}else this.error="密码错误，请重试"}catch(t){console.error("解锁失败:",t),this.error="解锁失败: "+t.message}else this.error="请输入密码"},showReset(){this.password="",this.error="",this.showResetConfirm=!0},cancelReset(){this.password="",this.error="",this.showResetConfirm=!1},async confirmReset(){if(this.password)try{const t=await this.unlockWallets({password:this.password});t?(localStorage.removeItem("encryptedData"),sessionStorage.removeItem("isUnlocked"),this.SET_UNLOCKED(!1),this.password="",this.confirmPassword="",this.error="",this.showResetConfirm=!1,this.isFirstTime=!0,console.log("数据删除成功，可以重新设置密码")):this.error="密码错误，无法删除数据"}catch(t){console.error("重置数据失败:",t),this.error="重置数据失败: "+t.message}else this.error="请输入密码"},showExport(){this.password="",this.error="",this.successMessage="",this.exportedData="",this.showExportForm=!0},cancelExport(){this.password="",this.error="",this.successMessage="",this.exportedData="",this.showExportForm=!1},async exportWalletData(){if(this.password)try{const t=await this.unlockWallets({password:this.password});t?(this.exportedData=localStorage.getItem("encryptedData"),this.exportedData||(this.error="没有找到钱包数据")):this.error="密码错误，无法导出数据"}catch(t){console.error("导出数据失败:",t),this.error="导出数据失败: "+t.message}else this.error="请输入密码"},copyExportedData(){this.exportedData&&navigator.clipboard.writeText(this.exportedData).then(()=>{this.successMessage="已复制到剪贴板",setTimeout(()=>{this.successMessage=""},3e3)}).catch(t=>{console.error("复制失败:",t),this.error="复制失败，请手动复制"})},showImport(){this.password="",this.importData="",this.error="",this.showImportForm=!0},cancelImport(){this.password="",this.importData="",this.error="",this.showImportForm=!1},async importWalletData(){if(this.password)if(this.importData)try{const{decryptData:s}=await Promise.resolve().then(r.bind(null,"90c5"));try{const t=s(this.importData,this.password);localStorage.setItem("encryptedData",this.importData),this.SET_WALLETS(t),this.SET_UNLOCKED(!0),this.SET_CURRENT_PASSWORD(this.password),this.$router.push("/operation").catch(t=>{"NavigationDuplicated"!==t.name&&console.error("导航到操作页面出错:",t)}),console.log("钱包数据导入成功")}catch(t){console.error("导入数据验证失败:",t),this.error="导入失败：密码错误或数据格式不正确"}}catch(t){console.error("导入钱包数据失败:",t),this.error="导入钱包数据失败: "+t.message}else this.error="请输入要导入的加密数据";else this.error="请输入密码"}}},n=i,c=(r("a99b"),r("2877")),l=Object(c["a"])(n,e,o,!1,null,"3fd0d37b",null);s["default"]=l.exports},a99b:function(t,s,r){"use strict";r("7e92")}}]);