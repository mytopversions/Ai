(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-205f141b"],{"86bd":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"operation-page"},[s("div",{staticClass:"container pb-tabs"},[s("div",{staticClass:"header-actions"},[s("h2",[t._v("钱包操作")]),s("div",{staticClass:"sort-options"},[s("div",{staticClass:"sort-option",class:{active:"default"===t.sortType},on:{click:function(a){return t.setSortType("default")}}},[t._v(" 默认 ")]),s("div",{staticClass:"sort-option",class:{active:"time"===t.sortType},on:{click:function(a){return t.setSortType("time")}}},[t._v(" 时间 ")])])]),t.loading?s("div",{staticClass:"loading-spinner"},[t._v(" 加载中... ")]):0===t.sortedWallets.length?s("div",{staticClass:"empty-state"},[s("p",[t._v("暂无钱包，请前往「钱包」页面创建或导入钱包")])]):s("div",{staticClass:"wallet-list"},t._l(t.sortedWallets,(function(a){return s("div",{key:a.address,staticClass:"card wallet-card"},[s("div",{staticClass:"wallet-header"},[s("div",{staticClass:"wallet-address"},[a.remark?s("span",{staticClass:"wallet-remark"},[t._v("【"+t._s(a.remark)+"】")]):t._e(),a.isWatchOnly?s("span",{staticClass:"watch-only-tag"},[t._v("【观察】")]):t._e(),t._v(" "+t._s(t.formatAddress(a.address))+" "),t.walletRefreshing[a.address]?s("span",{staticClass:"refresh-indicator"},[s("span",{staticClass:"refresh-text"},[t._v("(刷新中...)")])]):t._e()]),s("div",{staticClass:"wallet-balance"},[t._v(t._s(t.formatBalance(a.balance))+" TRX")])]),s("div",{staticClass:"wallet-info"},[s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-label"},[t._v("当前质押")]),s("div",{staticClass:"info-value"},[t._v(t._s(a.pledgeInfo?t.formatBalance(a.pledgeInfo.amount)+" TRX":"未质押"))])]),s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-label"},[t._v("当前参与")]),s("div",{staticClass:"info-value"},[t._v(t._s(a.participateInfo?t.formatBalance(a.participateInfo.amount)+" TRX":"未参与"))])]),s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-label"},[t._v("剩余额度")]),s("div",{staticClass:"info-value"},[t._v(t._s(a.remainingLimit?a.remainingLimit:0))])]),s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-label"},[t._v(t._s(a.participateInfo?"预计出局":"最后参与"))]),s("div",{staticClass:"info-value"},[t._v(t._s(a.participateInfo?t.formatTime(t.getExitTime(a)):t.getLastParticipateTime(a)?t.formatTime(t.getLastParticipateTime(a)):"-"))])]),a.participateInfo&&!a.participateInfo.matched?s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-label"},[t._v("参与状态")]),s("div",{staticClass:"info-value"},[t._v("未出局")])]):t._e(),t.getLatestWithdraw(a)?s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-label"},[t._v("最近收益")]),s("div",{staticClass:"info-value"},[t._v(t._s(t.formatBalance(t.getLatestWithdraw(a).profit))+" TRX")])]):t._e()]),s("div",{staticClass:"wallet-actions"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:a.isWatchOnly||t.pledgeLoading===a.address||a.balance<t.config.BALANCE_THRESHOLDS.MIN_PLEDGE},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.handlePledge(a)}}},[t._v(" 质押 "),t.pledgeLoading===a.address?s("span",[t._v("(处理中...)")]):t._e(),a.isWatchOnly?s("span",[t._v("(观察钱包)")]):t._e()]),s("button",{staticClass:"btn btn-success",attrs:{type:"button",disabled:a.isWatchOnly||t.participateLoading===a.address||a.balance<t.config.BALANCE_THRESHOLDS.MIN_PARTICIPATE||!a.pledgeInfo},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.handleParticipate(a)}}},[t._v(" 参与 "),t.participateLoading===a.address?s("span",[t._v("(处理中...)")]):t._e(),a.isWatchOnly?s("span",[t._v("(观察钱包)")]):t._e()]),s("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:a.isWatchOnly||t.withdrawLoading===a.address||a.balance<t.config.BALANCE_THRESHOLDS.MIN_WITHDRAW||!a.participateInfo},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.handleWithdraw(a)}}},[t._v(" 提现 "),t.withdrawLoading===a.address?s("span",[t._v("(处理中...)")]):t._e(),a.isWatchOnly?s("span",[t._v("(观察钱包)")]):t._e()])])])})),0)])])},i=[],n=s("2f62"),l=s("f121"),d={name:"Operation",data(){return{loading:!0,pledgeLoading:null,participateLoading:null,withdrawLoading:null,walletRefreshing:{},config:{TRANSACTION_AMOUNTS:l["e"],BALANCE_THRESHOLDS:l["b"],TIME_CONFIG:l["d"]}}},computed:{...Object(n["e"])(["sortType","isUnlocked"]),...Object(n["c"])(["sortedWalletsForOperation"]),sortedWallets(){return this.sortedWalletsForOperation}},created(){this.isUnlocked?this.fetchData():this.$router.push("/login")},methods:{...Object(n["d"])(["SET_SORT_TYPE"]),...Object(n["b"])(["updateAllWallets","updateSingleWallet","pledge","participate","withdraw"]),async fetchData(){this.loading=!0,await this.updateAllWallets(),this.loading=!1},setSortType(t){this.SET_SORT_TYPE(t)},async handlePledge(t){if(!this.pledgeLoading)if(t.balance<this.config.BALANCE_THRESHOLDS.MIN_PLEDGE)alert("余额不足，无法质押，需要至少 "+this.config.BALANCE_THRESHOLDS.MIN_PLEDGE+" TRX");else{this.pledgeLoading=t.address;try{const a=await this.pledge({address:t.address});a.success?(alert("质押交易发送成功，交易ID: "+a.txId),this.$set(this.walletRefreshing,t.address,!0),setTimeout(async()=>{await this.updateSingleWallet({address:t.address}),this.$set(this.walletRefreshing,t.address,!1)},this.config.TIME_CONFIG.REFRESH_DELAY)):alert("质押失败: "+a.message)}catch(a){alert("质押操作出错: "+a.message)}finally{this.pledgeLoading=null}}},async handleParticipate(t){if(!this.participateLoading)if(t.balance<this.config.BALANCE_THRESHOLDS.MIN_PARTICIPATE)alert("余额不足，无法参与，需要至少 "+this.config.BALANCE_THRESHOLDS.MIN_PARTICIPATE+" TRX");else if(t.pledgeInfo){this.participateLoading=t.address;try{const a=await this.participate({address:t.address});a.success?(alert("参与交易发送成功，交易ID: "+a.txId),this.$set(this.walletRefreshing,t.address,!0),setTimeout(async()=>{await this.updateSingleWallet({address:t.address}),this.$set(this.walletRefreshing,t.address,!1)},this.config.TIME_CONFIG.REFRESH_DELAY)):alert("参与失败: "+a.message)}catch(a){alert("参与操作出错: "+a.message)}finally{this.participateLoading=null}}else alert("您需要先质押才能参与")},async handleWithdraw(t){if(!this.withdrawLoading)if(t.balance<this.config.BALANCE_THRESHOLDS.MIN_WITHDRAW)alert("余额不足，无法提现，需要至少 "+this.config.BALANCE_THRESHOLDS.MIN_WITHDRAW+" TRX");else if(t.participateInfo){this.withdrawLoading=t.address;try{const a=await this.withdraw({address:t.address});a.success?(alert("提现交易发送成功，交易ID: "+a.txId),this.$set(this.walletRefreshing,t.address,!0),setTimeout(async()=>{await this.updateSingleWallet({address:t.address}),this.$set(this.walletRefreshing,t.address,!1)},this.config.TIME_CONFIG.REFRESH_DELAY)):alert("提现失败: "+a.message)}catch(a){alert("提现操作出错: "+a.message)}finally{this.withdrawLoading=null}}else alert("您需要先参与才能提现")},formatAddress(t){return t?t.substring(0,8)+"..."+t.substring(t.length-8):""},formatBalance(t){return void 0===t||null===t?"0":parseFloat(t).toFixed(2)},getExitTime(t){return t.participateInfo?t.participateInfo.time+this.config.TIME_CONFIG.PARTICIPATE_CYCLE:null},getLastParticipateTime(t){if(t.withdrawInfo&&t.withdrawInfo.length>0){const a=t.withdrawInfo[t.withdrawInfo.length-1];return a.time}return null},formatTime(t){if(!t)return"-";const a=new Date(t);return a.toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},getLatestWithdraw(t){return t.withdrawInfo&&t.withdrawInfo.length>0?t.withdrawInfo[t.withdrawInfo.length-1]:null}}},r=d,o=(s("c4df"),s("2877")),c=Object(o["a"])(r,e,i,!1,null,"0936a061",null);a["default"]=c.exports},b0e2:function(t,a,s){},c4df:function(t,a,s){"use strict";s("b0e2")}}]);